{% load static %}
<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ | Ø¥Ø´Ø±Ø§ÙØ§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¹Ù„ÙŠØ§</title>

  <style>
    :root{
      --bg: #0f172a;
      --panel: rgba(255,255,255,.08);
      --panel2: rgba(255,255,255,.12);
      --text: #e5e7eb;
      --muted: rgba(229,231,235,.7);
      --border: rgba(255,255,255,.14);
      --shadow: 0 20px 60px rgba(0,0,0,.35);
      --primary: #2563eb;
      --primary2: #1d4ed8;
      --danger: #ef4444;
      --ok: #22c55e;
      --focus: rgba(37,99,235,.35);
    }
    [data-theme="light"]{
      --bg: #f3f4f6;
      --panel: rgba(255,255,255,.72);
      --panel2: rgba(255,255,255,.92);
      --text: #0f172a;
      --muted: rgba(15,23,42,.65);
      --border: rgba(15,23,42,.10);
      --shadow: 0 18px 55px rgba(2,6,23,.12);
      --primary: #1d4ed8;
      --primary2: #1e40af;
      --danger: #dc2626;
      --focus: rgba(29,78,216,.22);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Kufi Arabic", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height:100vh;
      display:flex;
      align-items:stretch;
    }

    /* ====== Background image layer ====== */
    .bg{
      position:fixed;
      inset:0;
      background:
        linear-gradient(135deg, rgba(2,6,23,.85) 0%, rgba(2,6,23,.45) 55%, rgba(2,6,23,.75) 100%),
        url("{% static 'core/img/benha_pe.jpg' %}") center/cover no-repeat;
      filter:saturate(1.05);
      transform: scale(1.02);
      z-index:-2;
    }
    [data-theme="light"] .bg{
      background:
        linear-gradient(135deg, rgba(243,244,246,.92) 0%, rgba(243,244,246,.55) 55%, rgba(243,244,246,.92) 100%),
        url("{% static 'core/img/benha_pe.jpg' %}") center/cover no-repeat;
    }

    /* subtle animated glow */
    .glow{
      position:fixed;
      inset:-20%;
      background:
        radial-gradient(circle at 20% 30%, rgba(37,99,235,.18), transparent 45%),
        radial-gradient(circle at 80% 70%, rgba(34,197,94,.10), transparent 50%),
        radial-gradient(circle at 55% 10%, rgba(245,158,11,.10), transparent 45%);
      filter: blur(30px);
      z-index:-1;
      animation: floaty 10s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes floaty{
      0%,100%{ transform: translate3d(0,0,0) }
      50%{ transform: translate3d(0,-18px,0) }
    }

    /* ====== Layout ====== */
    .wrap{
      width: min(1100px, 100%);
      margin: auto;
      padding: 24px;
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 18px;
      align-items: stretch;
    }
    @media (max-width: 920px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .panel{
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }

    /* ====== Left info card ====== */
    .hero{
      padding: 26px;
      display:flex;
      flex-direction:column;
      gap: 18px;
      position:relative;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
    }
    .brand img{
      width: 52px;
      height: 52px;
      object-fit: contain;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 8px;
    }
    .brand .titles{
      line-height:1.15;
    }
    .brand .titles .h{
      font-weight: 800;
      font-size: 18px;
      letter-spacing: .2px;
    }
    .brand .titles .s{
      font-size: 13px;
      color: var(--muted);
      margin-top: 3px;
    }

    .theme-toggle{
      display:flex;
      align-items:center;
      gap: 8px;
      background: var(--panel2);
      border: 1px solid var(--border);
      padding: 8px 10px;
      border-radius: 999px;
      cursor:pointer;
      user-select:none;
      transition: transform .15s ease;
    }
    .theme-toggle:active{ transform: scale(.98); }
    .theme-dot{
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--primary);
      box-shadow: 0 0 0 4px rgba(37,99,235,.15);
    }
    .theme-text{ font-size: 13px; color: var(--muted); }

    .hero h1{
      margin: 0;
      font-size: 26px;
      font-weight: 900;
    }
    .hero p{
      margin: 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.8;
    }

    .admin-card{
      margin-top:auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 14px;
    }
    .admin-left{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width:0;
    }
    .admin-avatar{
      width: 56px; height: 56px;
      border-radius: 16px;
      overflow:hidden;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      flex:0 0 auto;
    }
    .admin-avatar img{
      width:100%; height:100%; object-fit: cover;
      transform: scale(1.05);
    }
    .admin-meta{ min-width:0; }
    .admin-meta .name{
      font-weight: 900;
      font-size: 15px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .admin-meta .role{
      margin-top: 3px;
      font-size: 13px;
      color: var(--muted);
    }
    .pill{
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(34,197,94,.14);
      border: 1px solid rgba(34,197,94,.24);
      color: var(--text);
      white-space:nowrap;
    }

    /* ====== Right login card ====== */
    .login{
      padding: 26px;
      display:flex;
      flex-direction:column;
      gap: 16px;
    }
    .login .title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .login h2{
      margin: 0;
      font-size: 20px;
      font-weight: 900;
    }
    .login .hint{
      margin: 6px 0 0 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.7;
    }

    .msg{
      border-radius: 14px;
      padding: 12px 12px;
      border: 1px solid var(--border);
      background: var(--panel2);
      font-size: 13px;
      line-height: 1.7;
    }
    .msg.error{
      border-color: rgba(239,68,68,.35);
      background: rgba(239,68,68,.10);
    }

    form{
      display:flex;
      flex-direction:column;
      gap: 12px;
      margin-top: 6px;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap: 7px;
    }
    .label{
      font-size: 13px;
      color: var(--muted);
    }
    .input{
      width:100%;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
      transition: box-shadow .15s ease, transform .15s ease, border-color .15s ease;
    }
    [data-theme="light"] .input{ background: rgba(255,255,255,.9); }
    .input:focus{
      border-color: rgba(37,99,235,.45);
      box-shadow: 0 0 0 5px var(--focus);
    }

    .actions{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-top: 2px;
    }

    .btn{
      width: 100%;
      padding: 12px 14px;
      border-radius: 14px;
      border: 0;
      cursor:pointer;
      font-weight: 900;
      background: linear-gradient(135deg, var(--primary), var(--primary2));
      color: white;
      box-shadow: 0 12px 28px rgba(37,99,235,.25);
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:active{ transform: scale(.99); }
    .btn[disabled]{
      cursor:not-allowed;
      filter: grayscale(.15) opacity(.8);
    }

    .spinner{
      width: 18px; height: 18px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,.35);
      border-top-color: rgba(255,255,255,1);
      animation: spin .75s linear infinite;
      display:none;
    }
    @keyframes spin { to { transform: rotate(360deg) } }

    /* ====== Error shake animation ====== */
    .shake{
      animation: shake .45s ease-in-out;
    }
    @keyframes shake{
      0%,100%{ transform: translateX(0) }
      20%{ transform: translateX(8px) }
      40%{ transform: translateX(-8px) }
      60%{ transform: translateX(6px) }
      80%{ transform: translateX(-6px) }
    }

    .foot{
      margin-top:auto;
      font-size: 12px;
      color: var(--muted);
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .kbd{
      border:1px solid var(--border);
      padding: 3px 8px;
      border-radius: 10px;
      background: rgba(255,255,255,.06);
    }

  </style>
</head>

<body data-theme="">
  <div class="bg"></div>
  <div class="glow"></div>

  <main class="wrap">

    <!-- Left: Brand / Info -->
    <section class="panel hero">
      <div class="topbar">
        <div class="brand">
          <img src="{% static 'core/img/faculty_logo.png' %}" alt="Logo">
          <div class="titles">
            <div class="h">Ø¥Ø´Ø±Ø§ÙØ§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¹Ù„ÙŠØ§</div>
            <div class="s">ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø±ÙŠØ§Ø¶Ø© â€” Ø¬Ø§Ù…Ø¹Ø© Ø¨Ù†Ù‡Ø§</div>
          </div>
        </div>

        <button type="button" class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <span class="theme-dot" aria-hidden="true"></span>
          <span class="theme-text" id="themeLabel">Dark</span>
        </button>
      </div>

      <div>
        <h1>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ğŸ‘‹</h1>
        <p>
          Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«ÙŠÙ† ÙˆØ§Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø­Ø³Ø¨ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨.
          <br>Ù„Ùˆ Ù†Ø³ÙŠØª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù…Ù†.
        </p>
      </div>

      <!-- Admin nice card -->
      <div class="admin-card">
        <div class="admin-left">
          <div class="admin-avatar">
            <img src="{% static 'core/img/admin.png' %}" alt="Admin">
          </div>
          <div class="admin-meta">
            <div class="name">Ø¯. Ø£Ø­Ù…Ø¯ Ø®Ù„ÙŠÙ„</div>
            <div class="role">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… (Admin)</div>
          </div>
        </div>
        <div class="pill">ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©</div>
      </div>
    </section>

    <!-- Right: Login form -->
    <section class="panel login">
      <div class="title">
        <div>
          <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
          <p class="hint">Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø«Ù… Ø§Ø¶ØºØ· Ø¯Ø®ÙˆÙ„.</p>
        </div>
      </div>

      {% if messages %}
        {% for message in messages %}
          <div class="msg {% if message.tags %}{{ message.tags }}{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}

      <form method="post" id="loginForm" novalidate>
        {% csrf_token %}

        <div class="field">
          <div class="label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div>
          <input class="input" type="text" name="username" id="username"
                 value="{{ username|default:'' }}" autocomplete="username" required />
        </div>

        <div class="field">
          <div class="label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</div>
          <input class="input" type="password" name="password" id="password"
                 autocomplete="current-password" required />
        </div>

        <button class="btn" type="submit" id="submitBtn">
          <span class="spinner" id="spinner" aria-hidden="true"></span>
          <span id="btnText">Ø¯Ø®ÙˆÙ„</span>
        </button>

        <div class="foot">
          <div>Ø§Ø®ØªØµØ§Ø±: <span class="kbd">Enter</span> Ù„Ù„Ø¯Ø®ÙˆÙ„</div>
          <div>Â© ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø±ÙŠØ§Ø¶Ø© â€” Ø¬Ø§Ù…Ø¹Ø© Ø¨Ù†Ù‡Ø§</div>
        </div>
      </form>
    </section>

  </main>

  <script>
    (function(){
      const root = document.body;
      const themeToggle = document.getElementById("themeToggle");
      const themeLabel = document.getElementById("themeLabel");

      function getPreferredTheme(){
        const saved = localStorage.getItem("theme");
        if(saved === "light" || saved === "dark") return saved;
        // fallback to system
        return window.matchMedia && window.matchMedia("(prefers-color-scheme: light)").matches ? "light" : "dark";
      }

      function applyTheme(t){
        root.setAttribute("data-theme", t);
        themeLabel.textContent = (t === "light") ? "Light" : "Dark";
        localStorage.setItem("theme", t);
      }

      applyTheme(getPreferredTheme());

      themeToggle.addEventListener("click", () => {
        const current = root.getAttribute("data-theme") || "dark";
        applyTheme(current === "dark" ? "light" : "dark");
      });

      // Loading on submit
      const form = document.getElementById("loginForm");
      const btn = document.getElementById("submitBtn");
      const spinner = document.getElementById("spinner");
      const btnText = document.getElementById("btnText");

      form.addEventListener("submit", () => {
        btn.disabled = true;
        spinner.style.display = "inline-block";
        btnText.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...";
      });

      // Error shake if Django messages include "error"
      const hasError = !!document.querySelector(".msg.error");
      if(hasError){
        const panel = document.querySelector(".panel.login");
        panel.classList.remove("shake");
        // force reflow
        void panel.offsetWidth;
        panel.classList.add("shake");

        // focus best field
        const u = document.getElementById("username");
        const p = document.getElementById("password");
        if(u && !u.value) u.focus();
        else if(p) p.focus();
      }
    })();
  </script>
</body>
</html>
